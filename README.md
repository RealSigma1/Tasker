# Tasker — CRUD API для задач 

## Работа с базой данных

В проекте реализован полноценный слой работы с базой данных с использованием **Spring Data JPA**.

### Используемая СУБД
- **H2 Database (in-memory)**
- Реляционная SQL-база данных
- Работает в памяти приложения


### Entity
Сущность `Task` отображается на таблицу в базе данных с помощью JPA-аннотаций:
- `@Entity`, `@Table`
- `@Id`
- `@Column`

Каждое поле объекта соответствует колонке в таблице.

### Repository
Для доступа к данным используется интерфейс:
```
TaskRepository extends JpaRepository<Task, UUID>
```

Через него реализованы все операции:
- сохранение (`save`)
- получение по id (`findById`)
- получение списка (`findAll`)
- удаление (`deleteById`)
- проверка существования (`existsById`)

### Транзакции
Сервисный слой использует `@Transactional`, что гарантирует:
- атомарность операций записи;
- корректную работу с persistence context;
- корректное управление жизненным циклом сущностей.

### Поведение данных
- Данные сохраняются в памяти приложения.
- После перезапуска сервиса база очищается.
- Это поведение удобно для тестирования

---

## Архитектура и принципы

Проект построен по слоистой архитектуре:

- Controller — HTTP API
- Service — бизнес-логика
- Repository — работа с БД
- Domain — сущности

### SOLID
- **Single Responsibility** — каждый слой отвечает за свою зону ответственности.
- **Dependency Inversion** — контроллеры и сервисы зависят от абстракций.
- Код расширяем без изменения существующих компонентов.

### CRUD
Поддерживаются все базовые операции:
- Create
- Read
- Update
- Delete

Каждая операция проходит через слой сервиса и репозитория.

---

## API
Базовый префикс: http://localhost:8080/api/tasks
### 1) Создать задачу

POST /api/tasks

Body:
```bash
{
  "title": "Buy milk",
  "description": "2 bottles",
  "deadline": "2025-12-25T12:00:00"
}
```
deadline можно не передавать или передать null.

### 2) Получить задачу по id

GET /api/tasks/{id}

### 3) Получить список задач

GET /api/tasks

### 4) Обновить задачу

PUT /api/tasks/{id}
``` bash
{
  "title": "Buy milk ASAP",
  "completed": true,
  "deadline": "2025-12-25T12:00:00"
}

```
### 5) Удалить задачу

DELETE /api/tasks/{id}

## Обработка ошибок

Ошибки возвращаются в едином формате:
``` bash
{
  "timestamp": "2025-12-24T20:33:56.347057106Z",
  "status": 400,
  "error": "..."
}
```

## Запуск проекта
Проект корректно запускается с помощью Docker
```bash
docker compose up --build

```
## Тестирование

В проекте реализованы **модульные тесты сервисного слоя**, проверяющие корректность бизнес-логики.

### Используемые инструменты
- **JUnit 5** — фреймворк для написания и запуска тестов;
- **Mockito** — библиотека для мокирования зависимостей.

### Уровень тестирования
Тестируется сервис `TaskServiceImpl` без запуска web-слоя и без подключения реальной базы данных.

### Подход к тестированию
- Репозиторий `TaskRepository` мокируется с помощью Mockito.
- Сервис тестируется изолированно.
- Для работы со временем используется объект `Clock` с фиксированным значением,
  что делает тесты воспроизводимыми и независимыми от системных часов.

### Покрываемые сценарии
Тесты проверяют:
- создание задачи и корректное заполнение полей;
- получение задачи по id;
- получение списка задач;
- обновление полей задачи (включая `completed` и `deadline`);
- удаление задачи;
- корректную обработку ошибок (например, при работе с несуществующей задачей).

## Вывод

В проекте реализована полноценная работа с базой данных:
- используется ORM (Hibernate через JPA);
- есть слой репозиториев;
- данные сохраняются и читаются из БД;

